% Generator: GNU source-highlight, by Lorenzo Bettini, http://www.gnu.org/software/src-highlite
\noindent
\mbox{}\textit{\textcolor{Brown}{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}} \\
\mbox{}\textit{\textcolor{Brown}{\#\#\#\ Función\ búsqueda\ tabú\ básica}} \\
\mbox{}\textit{\textcolor{Brown}{\#\#\#\ \ \ \ \ Para\ un\ data\ frame\ devuelve\ para\ el\ clasificador\ 3-knn\ el\ conjunto}} \\
\mbox{}\textit{\textcolor{Brown}{\#\#\#\ \ \ \ \ de\ características\ que\ se\ obtienen\ de\ aplicar\ la\ tabú\ con\ memoria}} \\
\mbox{}\textit{\textcolor{Brown}{\#\#\#\ \ \ \ \ a\ corto\ plazo}} \\
\mbox{}\textit{\textcolor{Brown}{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}} \\
\mbox{} \\
\mbox{}BT\ \textcolor{BrickRed}{\textless{}-}\ function\textcolor{BrickRed}{(}data\textcolor{BrickRed}{)}\textcolor{Red}{\{} \\
\mbox{}\ \ n\ \textcolor{BrickRed}{\textless{}-}\ ncol\textcolor{BrickRed}{(}data\textcolor{BrickRed}{)} \\
\mbox{}\ \ n\ \textcolor{BrickRed}{\textless{}-}\ n\textcolor{BrickRed}{-}\textcolor{Purple}{1} \\
\mbox{}\ \ mask\ \textcolor{BrickRed}{\textless{}-}\ sample\textcolor{BrickRed}{(}\textcolor{Purple}{0}\textcolor{BrickRed}{:}\textcolor{Purple}{1}\textcolor{BrickRed}{,}\ n\textcolor{BrickRed}{,}\ replace\textcolor{BrickRed}{=}TRUE\textcolor{BrickRed}{)} \\
\mbox{}\ \ mask\textcolor{BrickRed}{.}best\ \textcolor{BrickRed}{\textless{}-}\ mask \\
\mbox{}\ \ tasa\textcolor{BrickRed}{.}best\ \textcolor{BrickRed}{\textless{}-}\ tasa\textcolor{BrickRed}{.}clas\textcolor{BrickRed}{(}data\textcolor{BrickRed}{,}\ mask\textcolor{BrickRed}{.}best\textcolor{BrickRed}{)} \\
\mbox{}\ \ n\ \textcolor{BrickRed}{\textless{}-}\ length\textcolor{BrickRed}{(}mask\textcolor{BrickRed}{)} \\
\mbox{}\ \  \\
\mbox{}\ \ max\textcolor{BrickRed}{.}vecinos\ \textcolor{BrickRed}{\textless{}-}\ BT\textcolor{BrickRed}{.}max\textcolor{BrickRed}{.}vecinos \\
\mbox{}\ \ \textit{\textcolor{Brown}{\#\ Tamaño\ máximo\ de\ la\ lista\ tabú}} \\
\mbox{}\ \ max\textcolor{BrickRed}{.}tabu\ \textcolor{BrickRed}{\textless{}-}\ n\textcolor{BrickRed}{*}BT\textcolor{BrickRed}{.}coef\textcolor{BrickRed}{.}max\textcolor{BrickRed}{.}tabu \\
\mbox{}\ \  \\
\mbox{}\ \ \textit{\textcolor{Brown}{\#\ Lista\ tabú}} \\
\mbox{}\ \ tabu\textcolor{BrickRed}{.}list\ \textcolor{BrickRed}{\textless{}-}\ c\textcolor{BrickRed}{()} \\
\mbox{}\ \  \\
\mbox{}\ \ \textit{\textcolor{Brown}{\#\ Posición\ a\ escribir\ de\ la\ lista\ tabú}} \\
\mbox{}\ \ tl\textcolor{BrickRed}{.}pos\ \textcolor{BrickRed}{\textless{}-}\ \textcolor{Purple}{1} \\
\mbox{}\ \ n\textcolor{BrickRed}{.}eval\ \textcolor{BrickRed}{\textless{}-}\ \textcolor{Purple}{0} \\
\mbox{}\ \  \\
\mbox{}\ \ \textbf{\textcolor{Blue}{while}}\textcolor{BrickRed}{(}n\textcolor{BrickRed}{.}eval\ \textcolor{BrickRed}{\textless{}}\ max\textcolor{BrickRed}{.}eval\textcolor{BrickRed}{)}\textcolor{Red}{\{} \\
\mbox{}\ \ \ \ tasa\textcolor{BrickRed}{.}mejor\textcolor{BrickRed}{.}vecino\ \textcolor{BrickRed}{\textless{}-}\ \textcolor{Purple}{0} \\
\mbox{}\ \ \ \ pos\textcolor{BrickRed}{.}vecinos\ \textcolor{BrickRed}{\textless{}-}\ sample\textcolor{BrickRed}{(}\textcolor{Purple}{1}\textcolor{BrickRed}{:}n\textcolor{BrickRed}{,}\ min\textcolor{BrickRed}{(}c\textcolor{BrickRed}{(}max\textcolor{BrickRed}{.}vecinos\textcolor{BrickRed}{,}\ max\textcolor{BrickRed}{.}eval\textcolor{BrickRed}{-}n\textcolor{BrickRed}{.}eval\textcolor{BrickRed}{)))} \\
\mbox{}\ \ \ \  \\
\mbox{}\ \ \ \ evs\ \textcolor{BrickRed}{\textless{}-}\ sapply\textcolor{BrickRed}{(}pos\textcolor{BrickRed}{.}vecinos\textcolor{BrickRed}{,}\ function\textcolor{BrickRed}{(}j\textcolor{BrickRed}{)}\textcolor{Red}{\{} \\
\mbox{}\ \ \ \ \ \ m\ \textcolor{BrickRed}{\textless{}-}\ mask \\
\mbox{}\ \ \ \ \ \  \\
\mbox{}\ \ \ \ \ \ m\textcolor{BrickRed}{[}j\textcolor{BrickRed}{]}\ \textcolor{BrickRed}{\textless{}-}\ \textcolor{BrickRed}{(}m\textcolor{BrickRed}{[}j\textcolor{BrickRed}{]+}\textcolor{Purple}{1}\textcolor{BrickRed}{)\%\%}\textcolor{Purple}{2} \\
\mbox{}\ \ \ \ \ \ tasa\textcolor{BrickRed}{.}actual\ \textcolor{BrickRed}{\textless{}-}\ tasa\textcolor{BrickRed}{.}clas\textcolor{BrickRed}{(}data\textcolor{BrickRed}{,}\ m\textcolor{BrickRed}{)} \\
\mbox{}\ \ \ \ \ \  \\
\mbox{}\ \ \ \ \ \ \textbf{\textcolor{Blue}{if}}\ \textcolor{BrickRed}{(}j\ \textcolor{BrickRed}{\%}\textbf{\textcolor{Blue}{in}}\textcolor{BrickRed}{\%}\ tabu\textcolor{BrickRed}{.}list\textcolor{BrickRed}{)}\textcolor{Red}{\{} \\
\mbox{}\ \ \ \ \ \ \ \ \textit{\textcolor{Brown}{\#\ Si\ el\ criterio\ de\ aspiración\ no\ se\ cumple}} \\
\mbox{}\ \ \ \ \ \ \ \ \textit{\textcolor{Brown}{\#\ \ \ Asignamos\ un\ valor\ basura\ a\ la\ tasa\ para}} \\
\mbox{}\ \ \ \ \ \ \ \ \textit{\textcolor{Brown}{\#\ \ \ que\ no\ sea\ escogida\ como\ la\ mejor}} \\
\mbox{}\ \ \ \ \ \ \ \ \textbf{\textcolor{Blue}{if}}\ \textcolor{BrickRed}{(}tasa\textcolor{BrickRed}{.}actual\ \textcolor{BrickRed}{\textless{}=}\ tasa\textcolor{BrickRed}{.}best\textcolor{BrickRed}{)}\textcolor{Red}{\{} \\
\mbox{}\ \ \ \ \ \ \ \ \ \ tasa\textcolor{BrickRed}{.}actual\ \textcolor{BrickRed}{\textless{}-}\ \textcolor{Purple}{0} \\
\mbox{}\ \ \ \ \ \ \ \ \textcolor{Red}{\}} \\
\mbox{}\ \ \ \ \ \ \textcolor{Red}{\}} \\
\mbox{}\ \ \ \ \ \  \\
\mbox{}\ \ \ \ \ \ tasa\textcolor{BrickRed}{.}actual \\
\mbox{}\ \ \ \ \textcolor{Red}{\}}\textcolor{BrickRed}{)} \\
\mbox{}\ \ \ \  \\
\mbox{}\ \ \ \ j\ \textcolor{BrickRed}{\textless{}-}\ which\textcolor{BrickRed}{.}max\textcolor{BrickRed}{(}evs\textcolor{BrickRed}{)} \\
\mbox{}\ \ \ \ tasa\textcolor{BrickRed}{.}mejor\textcolor{BrickRed}{.}vecino\ \textcolor{BrickRed}{\textless{}-}\ evs\textcolor{BrickRed}{[}j\textcolor{BrickRed}{]} \\
\mbox{}\ \ \ \ tabu\textcolor{BrickRed}{.}elem\ \textcolor{BrickRed}{\textless{}-}\ pos\textcolor{BrickRed}{.}vecinos\textcolor{BrickRed}{[}j\textcolor{BrickRed}{]} \\
\mbox{}\ \ \ \ \textit{\textcolor{Brown}{\#\ Esto\ asigna\ a\ la\ solución\ actual\ el\ mejor\ vecino}} \\
\mbox{}\ \ \ \ mask\textcolor{BrickRed}{[}tabu\textcolor{BrickRed}{.}elem\textcolor{BrickRed}{]}\ \textcolor{BrickRed}{\textless{}-}\ \textcolor{BrickRed}{(}mask\textcolor{BrickRed}{[}tabu\textcolor{BrickRed}{.}elem\textcolor{BrickRed}{]+}\textcolor{Purple}{1}\textcolor{BrickRed}{)\%\%}\textcolor{Purple}{2} \\
\mbox{}\ \ \ \  \\
\mbox{}\ \ \ \ \textbf{\textcolor{Blue}{if}}\ \textcolor{BrickRed}{(}tasa\textcolor{BrickRed}{.}mejor\textcolor{BrickRed}{.}vecino\ \textcolor{BrickRed}{\textgreater{}}\ tasa\textcolor{BrickRed}{.}best\textcolor{BrickRed}{)}\textcolor{Red}{\{} \\
\mbox{}\ \ \ \ \ \ mask\textcolor{BrickRed}{.}best\ \textcolor{BrickRed}{\textless{}-}\ mask \\
\mbox{}\ \ \ \ \ \ tasa\textcolor{BrickRed}{.}best\ \textcolor{BrickRed}{\textless{}-}\ tasa\textcolor{BrickRed}{.}mejor\textcolor{BrickRed}{.}vecino \\
\mbox{}\ \ \ \ \textcolor{Red}{\}} \\
\mbox{}\ \ \ \  \\
\mbox{}\ \ \ \ \textit{\textcolor{Brown}{\#\ Introducimos\ en\ la\ lista\ tabú\ el\ elemento\ que\ ha\ dado\ lugar}} \\
\mbox{}\ \ \ \ \textit{\textcolor{Brown}{\#\ a\ la\ mejor\ solución\ del\ vecindario\ anterior}} \\
\mbox{}\ \ \ \ tabu\textcolor{BrickRed}{.}list\textcolor{BrickRed}{[}tl\textcolor{BrickRed}{.}pos\textcolor{BrickRed}{]}\ \textcolor{BrickRed}{\textless{}-}\ tabu\textcolor{BrickRed}{.}elem \\
\mbox{}\ \ \ \ tl\textcolor{BrickRed}{.}pos\ \textcolor{BrickRed}{\textless{}-}\ \textcolor{BrickRed}{(}tl\textcolor{BrickRed}{.}pos\ \textcolor{BrickRed}{\%\%}\ max\textcolor{BrickRed}{.}tabu\textcolor{BrickRed}{)}\ \textcolor{BrickRed}{+}\ \textcolor{Purple}{1} \\
\mbox{}\ \ \ \  \\
\mbox{}\ \ \ \ \textit{\textcolor{Brown}{\#\ Actualizamos\ el\ número\ de\ evaluaciones}} \\
\mbox{}\ \ \ \ n\textcolor{BrickRed}{.}eval\ \textcolor{BrickRed}{\textless{}-}\ n\textcolor{BrickRed}{.}eval\ \textcolor{BrickRed}{+}\ length\textcolor{BrickRed}{(}pos\textcolor{BrickRed}{.}vecinos\textcolor{BrickRed}{)} \\
\mbox{}\ \ \textcolor{Red}{\}} \\
\mbox{}\ \ mask\textcolor{BrickRed}{.}best \\
\mbox{}\textcolor{Red}{\}} \\
\mbox{}
